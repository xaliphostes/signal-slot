"use strict";var __spreadArrays=this&&this.__spreadArrays||function(){for(var e=0,n=0,r=arguments.length;n<r;n++)e+=arguments[n].length;for(var t=Array(e),o=0,n=0;n<r;n++)for(var s=arguments[n],i=0,c=s.length;i<c;i++,o++)t[o]=s[i];return t};function dump(e){e._mapSignals?(console.log("----------------------------------------"),console.log("Dumping Signal/slot for object",e.constructor.name),e._mapSignals.forEach(function(e,n){console.log("  - signal '"+n+"'"),e.forEach(function(e){void 0===e.slot?console.log("    - slot "+e.receiver.constructor.name):console.log("    - slot "+e.receiver.constructor.name+"."+e.slot)})}),console.log("----------------------------------------")):console.warn("Emitter is not configured to support any signal. Consider creating a signal first.")}function create(e,n){return void 0===e._mapSignals&&(e._mapSignals=new Map),e._mapSignals.has(n)?(console.warn("Signal named "+n+" already defined."),!1):(e._mapSignals.set(n,[]),!0)}Object.defineProperty(exports,"__esModule",{value:!0}),exports.emit=exports.disconnectAll=exports.disconnect=exports.isLocked=exports.unlock=exports.lock=exports.connect=exports.create=exports.dump=void 0,exports.dump=dump,exports.create=create;var InnerConnection=function(e,n,r,t){this.sender=e,this.receiver=n,this.slot=r,this.desc=t,this.locked=!1};function connect(e){if(!e.sender._mapSignals)return console.warn("Emitter is not configured to support any signal. Consider creating a signal first."),!1;if(!e.sender._mapSignals.has(e.signal))return console.warn('Emitter does not have a signal named "'+e.signal+'"'),!1;if("function"==typeof e.receiver)return e.sender._mapSignals.get(e.signal).push(new InnerConnection(e.sender,e.receiver)),!0;if(void 0===e.slot)return console.warn("Require to define the slot"),!1;var n=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e.receiver),e.slot);if(n){if(!n.get&&!n.value)return console.warn('Receiver does not have a slot named "'+e.slot+'"'),!1;e.sender._mapSignals.get(e.signal).push(new InnerConnection(e.sender,e.receiver,e.slot,n))}else{if(!e.receiver[e.slot])return console.warn('Receiver does not have a slot named "'+e.slot+'"'),!1;e.sender._mapSignals.get(e.signal).push(new InnerConnection(e.sender,e.receiver,e.slot,e.slot))}return!0}function getConnection(e){function n(e,n,r){for(var t=0;t<e.length;++t){var o=e[t];if(o.receiver===n&&o.slot===r)return o}}if(e.sender._mapSignals&&e.sender._mapSignals.has(e.signal)){var r=e.sender._mapSignals.get(e.signal);if("function"==typeof e.receiver)return n(r,e.receiver,e.slot);if(void 0!==e.slot){var t=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e.receiver),e.slot);if(t){if(t.get||t.value)return n(r,e.receiver,e.slot)}else if(e.receiver[e.slot])return n(r,e.receiver,e.slot)}}}function lock(e){e=getConnection(e);return void 0!==e&&(e.locked=!0)}function unlock(e){e=getConnection(e);return void 0!==e&&!(e.locked=!1)}function isLocked(e){e=getConnection(e);return void 0!==e&&e.locked}function disconnect(e){function n(e,n,r){for(var t=0;t<e.length;++t){var o=e[t];if(o.receiver===n&&o.slot===r)return e.splice(t,1),!0}return!1}if(!e.sender._mapSignals)return!1;if(!e.sender._mapSignals.has(e.signal))return!1;var r=e.sender._mapSignals.get(e.signal);if("function"==typeof e.receiver)return n(r,e.receiver);if(void 0===e.slot)return!1;var t=Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e.receiver),e.slot);return t?!(!t.get&&!t.value)&&n(r,e.receiver,e.slot):!!e.receiver[e.slot]&&n(r,e.receiver,e.slot)}function disconnectAll(e,n){if(!e._mapSignals)return!1;if(!e._mapSignals.has(n))return!1;n=e._mapSignals.get(n);return n.splice(0,n.length),!0}function emit(e,n){for(var r=[],t=2;t<arguments.length;t++)r[t-2]=arguments[t];return e._mapSignals?e._mapSignals.has(n)?(_trigger(e,n,r),!0):(console.warn("Source does not have the signal named "+n+"."),!1):(console.warn("Source does not support Signal/Slot."),!1)}function _trigger(e,n,t){e._mapSignals.get(n).forEach(function(e){var n,r;!0!==e.locked&&(void 0===e.desc?e.receiver.apply(e,t):e.desc.value?(n=e.desc.value).call.apply(n,__spreadArrays([e.receiver],t)):e.desc.set?(r=e.desc.set).call.apply(r,__spreadArrays([e.receiver],t)):(r=e.receiver[e.desc]).call.apply(r,__spreadArrays([e.receiver],t)))})}exports.connect=connect,exports.lock=lock,exports.unlock=unlock,exports.isLocked=isLocked,exports.disconnect=disconnect,exports.disconnectAll=disconnectAll,exports.emit=emit;